# Виджеты HR Recruiter

Этот документ описывает систему виджетов для платформы HR Recruiter, которая была полностью переработана согласно плану FIX_WIDGETS.md.

## Обзор

Виджеты представляют собой модульные компоненты интерфейса, которые отображают различную информацию и предоставляют функциональность для работы с системой найма. Все виджеты используют единую архитектуру и API клиент для получения данных.

## Архитектура

### BaseWidget
Базовый компонент для всех виджетов, предоставляющий:
- Единообразный заголовок с кнопками управления
- Обработку состояний загрузки и ошибок
- Возможность перетаскивания и изменения размера
- Поддержку выделения и закрытия

### WidgetHeader
Заголовок виджета с расширенными возможностями:
- Название и подзаголовок
- Кнопка обновления данных
- Кнопка добавления новых элементов
- Кнопка настроек виджета
- Кнопка закрытия
- Индикатор загрузки

## Доступные виджеты

### 1. VacancyListWidget - Список вакансий
**Описание:** Основной виджет для управления вакансиями и просмотра связанных интервью.

**Особенности:**
- Двухпанельный интерфейс (список вакансий + детали)
- Ссылки на интервью сессии для каждой вакансии
- Статистика по каждой вакансии
- Фильтрация и настройки отображения
- Кнопка быстрого создания вакансии

**API интеграция:**
- `PositionsApi.listPositions()` - получение списка вакансий
- `PositionsApi.getPositionStats()` - статистика по вакансии
- `InterviewsApi.listPositionInterviews()` - интервью по вакансии

### 2. DashboardWidget - Общий дашборд
**Описание:** Виджет с общей статистикой и ключевыми метриками.

**Особенности:**
- Настраиваемые метрики с трендами
- Прогресс-бары для отслеживания процессов
- Список последних вакансий
- Быстрые действия для навигации

### 3. ReportsWidget - Отчеты
**Описание:** Виджет для отображения аналитики и отчетов.

**Особенности:**
- Метрики с трендами и изменениями
- Мини-графики для визуализации данных
- Фильтрация по периодам (неделя/месяц/квартал)
- Экспорт и детальные отчеты

### 4. AccountWidget - Профиль пользователя
**Описание:** Виджет для отображения информации о пользователе.

**Особенности:**
- Информация о пользователе с аватаром
- Статистика активности пользователя
- Кнопка выхода из системы
- Ссылка на настройки профиля

**API интеграция:**
- `AccountApi.getAccount()` - данные аккаунта
- `AccountApi.getUserInfo()` - информация о пользователе
- `AccountApi.logout()` - выход из системы

### 5. StatsWidget - Статистика
**Описание:** Детальный виджет статистики с графиками.

**Особенности:**
- Круговая диаграмма распределения интервью
- Метрики с трендами
- Детальная статистика по категориям
- Настройки отображения

### 6. RecentInterviewsWidget - Последние интервью
**Описание:** Виджет для отображения последних интервью с фильтрацией.

**Особенности:**
- Список интервью с детальной информацией
- Фильтрация по статусу
- Статистика по интервью
- Ссылки на интервью сессии

**API интеграция:**
- `InterviewsApi.listInterviews()` - список интервью

## Использование

### Импорт виджета
```typescript
import { VacancyListWidget } from '../components/widgets';
```

### Базовое использование
```typescript
<VacancyListWidget
  id="widget-1"
  isSelected={false}
  onClose={() => handleClose()}
  onRefresh={() => handleRefresh()}
/>
```

### С настройками
```typescript
<VacancyListWidget
  id="widget-1"
  isSelected={selectedWidget === 'widget-1'}
  onClick={() => setSelectedWidget('widget-1')}
  onClose={() => removeWidget('widget-1')}
  onRefresh={() => refreshWidget('widget-1')}
  onMouseDown={(e) => handleDragStart(e, 'widget-1')}
/>
```

## API интеграция

Все виджеты используют сгенерированный API клиент из папки `/client`. Основные API:

### Positions API
- `listPositions()` - получение списка вакансий
- `getPosition()` - получение вакансии по ID
- `getPositionStats()` - статистика по вакансии
- `createPosition()` - создание вакансии

### Interviews API
- `listInterviews()` - список интервью
- `getInterview()` - получение интервью по ID
- `listPositionInterviews()` - интервью по вакансии
- `createInterviewFromCandidate()` - создание интервью

### Account API
- `getAccount()` - данные аккаунта
- `getUserInfo()` - информация о пользователе
- `logout()` - выход из системы

## Стилизация

Виджеты используют Tailwind CSS для стилизации. Основные классы:

- `bg-white border border-gray-300 rounded` - базовый контейнер
- `bg-{color}-50 border-{color}-200` - цветные блоки
- `text-xs text-gray-600` - мелкий текст
- `font-semibold text-gray-800` - заголовки
- `hover:bg-{color}-50` - эффекты наведения

## Конфигурация

Каждый виджет имеет конфигурацию в `WIDGET_CONFIGS`:

```typescript
'vacancy-list': {
  title: 'Список вакансий',
  description: 'Управление вакансиями и просмотр интервью',
  minWidth: 800,
  minHeight: 600,
  defaultWidth: 900,
  defaultHeight: 700
}
```

## Расширение

Для создания нового виджета:

1. Создайте компонент, наследующий от `BaseWidget`
2. Добавьте хук для получения данных
3. Реализуйте интерфейс `WidgetProps`
4. Добавьте конфигурацию в `WIDGET_CONFIGS`
5. Экспортируйте в `index.ts`

## Пример нового виджета

```typescript
import React from 'react';
import BaseWidget from './BaseWidget';
import { useCustomWidgetData } from '../../hooks/useWidgetData';

const CustomWidget: React.FC<WidgetProps> = ({
  id,
  isSelected,
  onClick,
  onClose,
  onRefresh,
  onMouseDown
}) => {
  const { data, loading, error } = useCustomWidgetData(id);

  return (
    <BaseWidget
      id={id}
      isSelected={isSelected}
      onClick={onClick}
      onClose={onClose}
      onRefresh={onRefresh}
      onMouseDown={onMouseDown}
      title="Мой виджет"
      loading={loading}
      error={error}
      className="min-w-[400px] min-h-[300px]"
    >
      {/* Содержимое виджета */}
    </BaseWidget>
  );
};

export default CustomWidget;
```

## Заключение

Система виджетов предоставляет гибкий и расширяемый способ отображения информации в HR Recruiter. Все виджеты следуют единым принципам дизайна и архитектуры, обеспечивая консистентный пользовательский опыт. 